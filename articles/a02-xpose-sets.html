<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using xpose sets • xpose.xtras</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using xpose sets">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xpose.xtras</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a01-the-xp_xtra-object.html">The extended xpose data object</a></li>
    <li><a class="dropdown-item" href="../articles/a02-xpose-sets.html">Using xpose sets</a></li>
    <li><a class="dropdown-item" href="../articles/a03-useful_plots.html">Useful uncommon plots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jprybylski/xpose.xtras/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="a02-xpose-sets_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="a02-xpose-sets_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="a02-xpose-sets_files/viz-1.8.2/viz.js"></script><link href="a02-xpose-sets_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="a02-xpose-sets_files/grViz-binding-1.0.11/grViz.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using xpose sets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jprybylski/xpose.xtras/blob/master/vignettes/a02-xpose-sets.Rmd" class="external-link"><code>vignettes/a02-xpose-sets.Rmd</code></a></small>
      <div class="d-none name"><code>a02-xpose-sets.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A powerful new object building upon the <code>xpose</code> framework
is the <code>xpose_set</code>. Much like how <code>xpose_data</code> is
in essence a list of information and data about the fitted model,
<code>xpose_set</code> is a list of <code>xpose_data</code> (or
<code>xp_xtras</code>) objects with information about how these models
relate to one another.</p>
<p>Creating a set is easy. An important point to remember about usage is
that each set item must have a label. Depending on how the set is
created, the default is to use the name of the <code>xpose_data</code>
object, but if an unnamed list is spliced or any objects share the same
label, an error will occur. Note, however, that duplicate
<code>xpose_data</code> objects can be used, as long as they have
different labels. In the <code><a href="../reference/xpose_set.html">xpose_set()</a></code> example below, three
example models fitting the same dataset are made into a set, and
alternative labels are used for one version of the set.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/xpose_set.html">xpose_set</a></span><span class="op">(</span><span class="va">pheno_base</span>, <span class="va">pheno_final</span>, <span class="va">pheno_saem</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="color: #0000BB; font-weight: bold;">xpose_set</span><span style="font-weight: bold;"> object</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Number of models: 3</span></span>
<span><span class="co">#&gt; • Model labels: pheno_base, pheno_final, and pheno_saem</span></span>
<span><span class="co">#&gt; • Number of relationships: 0</span></span>
<span><span class="co">#&gt; • Focused xpdb objects: none</span></span>
<span><span class="co">#&gt; • Exposed properties: none</span></span>
<span><span class="co">#&gt; • Base model: none</span></span>
<span><span class="fu"><a href="../reference/xpose_set.html">xpose_set</a></span><span class="op">(</span>base<span class="op">=</span><span class="va">pheno_base</span>, reparam<span class="op">=</span><span class="va">pheno_final</span>, reparam_saem<span class="op">=</span><span class="va">pheno_saem</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="color: #0000BB; font-weight: bold;">xpose_set</span><span style="font-weight: bold;"> object</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Number of models: 3</span></span>
<span><span class="co">#&gt; • Model labels: base, reparam, and reparam_saem</span></span>
<span><span class="co">#&gt; • Number of relationships: 0</span></span>
<span><span class="co">#&gt; • Focused xpdb objects: none</span></span>
<span><span class="co">#&gt; • Exposed properties: none</span></span>
<span><span class="co">#&gt; • Base model: none</span></span></code></pre></div>
<p>The <code>print</code> output hints at features that will be explored
in this vignette. A few example sets are in the package that can be used
to test some of the elements discussed here. A relatively complex
example explores typical model-building steps for the common
phenobarbital in neonates dataset, called <code>pheno_set</code>,
diagrammed below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/diagram_lineage.html">diagram_lineage</a></span><span class="op">(</span><span class="va">pheno_set</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rich-iannone.github.io/DiagrammeR/reference/render_graph.html" class="external-link">render_graph</a></span><span class="op">(</span>layout<span class="op">=</span><span class="st">"tree"</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"run3\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-1.5,6!\"] \n  \"2\" [label = \"run4\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-1,5!\"] \n  \"3\" [label = \"run5\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-1,5!\"] \n  \"4\" [label = \"run6\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-1,4!\"] \n  \"5\" [label = \"run10\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-3,3!\"] \n  \"6\" [label = \"run12\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-3,2!\"] \n  \"7\" [label = \"run11\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,3!\"] \n  \"8\" [label = \"run13\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,2!\"] \n  \"9\" [label = \"run7\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-1,3!\"] \n  \"10\" [label = \"run8\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-2,3!\"] \n  \"11\" [label = \"run9\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1,3!\"] \n  \"12\" [label = \"run14\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1,2!\"] \n  \"13\" [label = \"run15\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0.5,1!\"] \n  \"14\" [label = \"run16\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1.5,1!\"] \n  \"1\"->\"2\" \n  \"1\"->\"3\" \n  \"3\"->\"4\" \n  \"4\"->\"5\" \n  \"5\"->\"6\" \n  \"4\"->\"7\" \n  \"7\"->\"8\" \n  \"4\"->\"9\" \n  \"4\"->\"10\" \n  \"4\"->\"11\" \n  \"11\"->\"12\" \n  \"12\"->\"13\" \n  \"12\"->\"14\" \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="relationships">Relationships<a class="anchor" aria-label="anchor" href="#relationships"></a>
</h2>
<p>Relationships between models in a set can be declared with formula
notation, where one or more child models is dependent on one or more
parents (<code>child1+... ~ parent1+...</code>). To demonstrate, parts
of <code>pheno_set</code> can be reproduced.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phrun3</span> <span class="op">&lt;-</span> <span class="va">pheno_set</span><span class="op">$</span><span class="va">run3</span><span class="op">$</span><span class="va">xpdb</span></span>
<span><span class="va">phrun5</span> <span class="op">&lt;-</span> <span class="va">pheno_set</span><span class="op">$</span><span class="va">run5</span><span class="op">$</span><span class="va">xpdb</span></span>
<span><span class="va">phrun6</span> <span class="op">&lt;-</span> <span class="va">pheno_set</span><span class="op">$</span><span class="va">run6</span><span class="op">$</span><span class="va">xpdb</span></span>
<span><span class="va">phrun7</span> <span class="op">&lt;-</span> <span class="va">pheno_set</span><span class="op">$</span><span class="va">run7</span><span class="op">$</span><span class="va">xpdb</span></span>
<span><span class="va">phrun8</span> <span class="op">&lt;-</span> <span class="va">pheno_set</span><span class="op">$</span><span class="va">run8</span><span class="op">$</span><span class="va">xpdb</span></span>
<span><span class="va">phrun9</span> <span class="op">&lt;-</span> <span class="va">pheno_set</span><span class="op">$</span><span class="va">run9</span><span class="op">$</span><span class="va">xpdb</span></span>
<span><span class="va">pheno_stem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xpose_set.html">xpose_set</a></span><span class="op">(</span><span class="va">phrun3</span>,<span class="va">phrun5</span>,<span class="va">phrun6</span>, .as_ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pheno_stem</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="color: #0000BB; font-weight: bold;">xpose_set</span><span style="font-weight: bold;"> object</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Number of models: 3</span></span>
<span><span class="co">#&gt; • Model labels: phrun3, phrun5, and phrun6</span></span>
<span><span class="co">#&gt; • Number of relationships: 2</span></span>
<span><span class="co">#&gt; • Focused xpdb objects: none</span></span>
<span><span class="co">#&gt; • Exposed properties: none</span></span>
<span><span class="co">#&gt; • Base model: none</span></span>
<span><span class="fu"><a href="../reference/diagram_lineage.html">diagram_lineage</a></span><span class="op">(</span><span class="va">pheno_stem</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rich-iannone.github.io/DiagrammeR/reference/render_graph.html" class="external-link">render_graph</a></span><span class="op">(</span>layout<span class="op">=</span><span class="st">"tree"</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"phrun3\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,3!\"] \n  \"2\" [label = \"phrun5\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,2!\"] \n  \"3\" [label = \"phrun6\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,1!\"] \n  \"1\"->\"2\" \n  \"2\"->\"3\" \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pheno_branch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xpose_set.html">xpose_set</a></span><span class="op">(</span><span class="va">phrun6</span>,<span class="va">phrun7</span>,<span class="va">phrun8</span>,<span class="va">phrun9</span>, .relationships <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">phrun7</span><span class="op">+</span><span class="va">phrun8</span><span class="op">+</span><span class="va">phrun9</span><span class="op">~</span><span class="va">phrun6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pheno_branch</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="color: #0000BB; font-weight: bold;">xpose_set</span><span style="font-weight: bold;"> object</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Number of models: 4</span></span>
<span><span class="co">#&gt; • Model labels: phrun6, phrun7, phrun8, and phrun9</span></span>
<span><span class="co">#&gt; • Number of relationships: 3</span></span>
<span><span class="co">#&gt; • Focused xpdb objects: none</span></span>
<span><span class="co">#&gt; • Exposed properties: none</span></span>
<span><span class="co">#&gt; • Base model: none</span></span>
<span><span class="fu"><a href="../reference/diagram_lineage.html">diagram_lineage</a></span><span class="op">(</span><span class="va">pheno_branch</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rich-iannone.github.io/DiagrammeR/reference/render_graph.html" class="external-link">render_graph</a></span><span class="op">(</span>layout<span class="op">=</span><span class="st">"tree"</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"phrun6\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1,2!\"] \n  \"2\" [label = \"phrun7\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,1!\"] \n  \"3\" [label = \"phrun8\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1,1!\"] \n  \"4\" [label = \"phrun9\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"2,1!\"] \n  \"1\"->\"2\" \n  \"1\"->\"3\" \n  \"1\"->\"4\" \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Trees can also be concatenated, using typical R/tidyverse syntax.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pheno_tree</span> <span class="op">&lt;-</span> <span class="va">pheno_stem</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># drop phrun6 from stem</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">phrun6</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">pheno_branch</span>,</span>
<span>    .relationships <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">phrun6</span><span class="op">~</span><span class="va">phrun5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">pheno_tree</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="color: #0000BB; font-weight: bold;">xpose_set</span><span style="font-weight: bold;"> object</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Number of models: 6</span></span>
<span><span class="co">#&gt; • Model labels (truncated): phrun3, phrun5, phrun6, phrun7, and phrun8 (...)</span></span>
<span><span class="co">#&gt; • Number of relationships: 5</span></span>
<span><span class="co">#&gt; • Focused xpdb objects: none</span></span>
<span><span class="co">#&gt; • Exposed properties: none</span></span>
<span><span class="co">#&gt; • Base model: none</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"># ℹ 1 more xpdbs</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"># ℹ Use `print(n = ...)` to see more than n = 5</span></span></span>
<span><span class="fu"><a href="../reference/diagram_lineage.html">diagram_lineage</a></span><span class="op">(</span><span class="va">pheno_tree</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rich-iannone.github.io/DiagrammeR/reference/render_graph.html" class="external-link">render_graph</a></span><span class="op">(</span>layout<span class="op">=</span><span class="st">"tree"</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"phrun3\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1,4!\"] \n  \"2\" [label = \"phrun5\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1,3!\"] \n  \"3\" [label = \"phrun6\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1,2!\"] \n  \"4\" [label = \"phrun7\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,1!\"] \n  \"5\" [label = \"phrun8\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1,1!\"] \n  \"6\" [label = \"phrun9\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"2,1!\"] \n  \"1\"->\"2\" \n  \"2\"->\"3\" \n  \"3\"->\"4\" \n  \"3\"->\"5\" \n  \"3\"->\"6\" \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>The documentation for <code><a href="../reference/add_relationship.html">?add_relationship</a></code> contains more
information about declaring and removing relationships. Users should be
aware that model lineage is actually used by some functions that process
<code>xpose_set</code> objects to generate output, so declaring
parentage should be done only when it is valid. This does not mean
necessarily that the child should be nested in the parent(s), but
lineage is considered relevant in functions that compare models.</p>
</div>
<div class="section level2">
<h2 id="comparing-models-in-sets">Comparing models in sets<a class="anchor" aria-label="anchor" href="#comparing-models-in-sets"></a>
</h2>
<p>Models in a set can be compared with a few functions and plots. The
functions for comparison include a <code><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff()</a></code> method.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">pheno_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -148.723  -37.080  -60.163  -43.281   35.133</span></span></code></pre></div>
<p>The method above limits the comparison to the longest lineage in the
provided set, starting at a base model if one is declared. The models
included can be examined by probing with the <code><a href="../reference/xset_lineage.html">xset_lineage()</a></code>
function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_diff</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">set</span><span class="op">)</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  models <span class="op">=</span> <span class="fu"><a href="../reference/xset_lineage.html">xset_lineage</a></span><span class="op">(</span><span class="va">set</span><span class="op">)</span>,</span>
<span>  diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">set</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">tbl_diff</span><span class="op">(</span><span class="va">pheno_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   models   diff</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> run3      0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> run5   -<span style="color: #BB0000;">149.</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> run6    -<span style="color: #BB0000;">37.1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> run9    -<span style="color: #BB0000;">60.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> run14   -<span style="color: #BB0000;">43.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> run15    35.1</span></span>
<span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_relationship.html">remove_relationship</a></span><span class="op">(</span><span class="va">run9</span><span class="op">~</span><span class="va">run6</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tbl_diff</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">#&gt;   models      diff</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> run3      0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> run5   -<span style="color: #BB0000;">149.</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> run6    -<span style="color: #BB0000;">37.1</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> run10    -<span style="color: #BB0000;">0.023</span><span style="color: #BB0000; text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> run12    -<span style="color: #BB0000;">0.181</span></span></span>
<span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_base_model.html">set_base_model</a></span><span class="op">(</span><span class="va">run6</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tbl_diff</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   models  diff</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> run6     0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> run9   -<span style="color: #BB0000;">60.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> run14  -<span style="color: #BB0000;">43.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> run15   35.1</span></span>
<span><span class="fu">tibble</span><span class="op">(</span></span>
<span>  models <span class="op">=</span> <span class="fu"><a href="../reference/xset_lineage.html">xset_lineage</a></span><span class="op">(</span><span class="va">pheno_set</span>,<span class="va">run6</span><span class="op">)</span>,</span>
<span>  diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">pheno_set</span>,<span class="va">run6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   models  diff</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> run6     0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> run9   -<span style="color: #BB0000;">60.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> run14  -<span style="color: #BB0000;">43.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> run15   35.1</span></span></code></pre></div>
<p><code><a href="../reference/xset_lineage.html">xset_lineage()</a></code> and <code><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff()</a></code> can also generate
lists if multiple models are passed to <code>...</code>, which treats
those as base models.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">pheno_set</span>, <span class="va">run10</span>,<span class="va">run9</span><span class="op">)</span></span>
<span><span class="co">#&gt; $run10</span></span>
<span><span class="co">#&gt; [1] -0.181</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $run9</span></span>
<span><span class="co">#&gt; [1] -43.281  35.133</span></span>
<span><span class="fu"><a href="../reference/xset_lineage.html">xset_lineage</a></span><span class="op">(</span><span class="va">pheno_set</span>, <span class="va">run10</span>,<span class="va">run9</span><span class="op">)</span></span>
<span><span class="co">#&gt; $run10</span></span>
<span><span class="co">#&gt; [1] "run10" "run12"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $run9</span></span>
<span><span class="co">#&gt; [1] "run9"  "run14" "run15"</span></span></code></pre></div>
<p>Models can also be compared through various plots. Many that use
individual objective function values (iOFVs) require these values to be
in the <code>xpdb</code> data. If these are missing and the
<code>xpose_data</code> object is generated based on a NONMEM run, these
can be added with the <code><a href="../reference/backfill_iofv.html">backfill_iofv()</a></code> function. We discuss
focusing in another section, but it is useful here,</p>
<p>Two models can be compared one way using an updated version of a
<code>xpose4</code> function; this is referred to in some places as a
“shark plot”, and it is called <code>xpose4::dOFV.vs.id()</code> in
<code>xpose4</code>. As such, it is called <code><a href="../reference/shark_plot.html">shark_plot()</a></code> or
<code><a href="../reference/shark_plot.html">dofv_vs_id()</a></code> in <code>xpose.xtras</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/focus_xpdb.html">focus_qapply</a></span><span class="op">(</span><span class="va">backfill_iofv</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/shark_plot.html">shark_plot</a></span><span class="op">(</span><span class="va">run6</span>, <span class="va">run9</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a02-xpose-sets_files/figure-html/shark-1.png" width="672inches" style="display: block; margin: auto;"></p>
<p>There are also functions to use an <code>xpose_set</code> for
model-averaging and other ways to visually explore the impact of model
changes on individual fits which are all documented within the package.
Many of these are considered experimental, but all facilitate further
improvements.</p>
</div>
<div class="section level2">
<h2 id="manipulating-a-set">Manipulating a set<a class="anchor" aria-label="anchor" href="#manipulating-a-set"></a>
</h2>
<p>We have already explored a few ways to manipulate a set. These
manipulations are distinctly designed so that a user can change the
overall set or <code>xpose_data</code> elements within the set using
fairly intuitive functionality.</p>
<p>Information from <code>xpose_data</code> summary or parameter values
can be “exposed”, which means they become associated with the set item
on the top level. To view these as a table, the function
<code><a href="../reference/reshape_set.html">reshape_set()</a></code> can be used. Note the exposed data are
denoted by the prefix <code>..</code> (two dots) in their column
names.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/expose_property.html">expose_property</a></span><span class="op">(</span><span class="va">ofv</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/expose_param.html">expose_param</a></span><span class="op">(</span><span class="va">ome1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/reshape_set.html">reshape_set</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   xpdb         label parent       base  focus ..ofv ..ome1</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;named list&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;named list&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">&lt;xp_xtras&gt;</span>   run3  <span style="color: #949494;">&lt;chr [1]&gt;</span>    FALSE FALSE  874.  1.69 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">&lt;xp_xtras&gt;</span>   run4  <span style="color: #949494;">&lt;chr [1]&gt;</span>    FALSE FALSE  834.  0.608</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #949494;">&lt;xp_xtras&gt;</span>   run5  <span style="color: #949494;">&lt;chr [1]&gt;</span>    FALSE FALSE  726.  0.198</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #949494;">&lt;xp_xtras&gt;</span>   run6  <span style="color: #949494;">&lt;chr [1]&gt;</span>    FALSE FALSE  689.  0.239</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="color: #949494;">&lt;xp_xtras&gt;</span>   run10 <span style="color: #949494;">&lt;chr [1]&gt;</span>    FALSE FALSE  688.  0.243</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> <span style="color: #949494;">&lt;xp_xtras&gt;</span>   run12 <span style="color: #949494;">&lt;chr [1]&gt;</span>    FALSE FALSE  688.  0.232</span></span></code></pre></div>
<p>There are methods for the popular <code>dplyr</code> verbs which
attempt to produce the expected results despite the underlying structure
of an <code>xpose_set</code> not being tabular.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">run3</span>,<span class="va">run15</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "run3"  "run15"</span></span>
<span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Note renaming can affect parentage.</span></span>
<span>  <span class="co"># For simplicity, this method does not change </span></span>
<span>  <span class="co"># parent automatically in child</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>NewName <span class="op">=</span> <span class="va">run3</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "NewName" "run4"    "run5"    "run6"    "run10"   "run12"   "run11"  </span></span>
<span><span class="co">#&gt;  [8] "run13"   "run7"    "run8"    "run9"    "run14"   "run15"   "run16"</span></span>
<span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/expose_property.html">expose_property</a></span><span class="op">(</span><span class="va">ofv</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">..ofv</span> <span class="op">&lt;</span> <span class="fl">700</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "run6"  "run10" "run12" "run11" "run13" "run7"  "run8"  "run9"  "run14"</span></span>
<span><span class="co">#&gt; [10] "run15" "run16"</span></span>
<span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/expose_param.html">expose_param</a></span><span class="op">(</span><span class="va">ome1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">..ome1</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1.69000 0.60800 0.19800 0.23900 0.24270 0.23200 0.23700 0.22800 0.25400</span></span>
<span><span class="co">#&gt; [10] 0.03432 0.17600 0.03870 0.03470 0.04037</span></span></code></pre></div>
<p>These verbs are also defined for <code>xpose_data</code> objects, and
it may be desired to “forward” the function to the
<code>xpose_data</code> objects in a set instead of applying them to the
set object. That functionality is available through focusing. Focused
elements in the set automatically forward functions to the
<code>xpose_data</code> objects in the element, and do nothing to
unfocused elements.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">focus_test</span> <span class="op">&lt;-</span> <span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/focus_xpdb.html">focus_xpdb</a></span><span class="op">(</span><span class="va">run3</span>,<span class="va">run15</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>test_col <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/focus_xpdb.html">unfocus_xpdb</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu">get_data</span><span class="op">(</span><span class="va">focus_test</span><span class="op">$</span><span class="va">run6</span><span class="op">$</span><span class="va">xpdb</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CWRES" "NPDE"  "DV"    "PRED"  "RES"   "WRES"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu">get_data</span><span class="op">(</span><span class="va">focus_test</span><span class="op">$</span><span class="va">run3</span><span class="op">$</span><span class="va">xpdb</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "NPDE"     "DV"       "PRED"     "RES"      "WRES"     "test_col"</span></span></code></pre></div>
<p>Any function can be passed to focused <code>xpose_data</code> objects
with <code><a href="../reference/focus_xpdb.html">focus_function()</a></code>. A shortcut for focusing everything,
applying a function and unfocusing everything is available in the form
of <code><a href="../reference/focus_xpdb.html">focus_qapply()</a></code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Prybylski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
