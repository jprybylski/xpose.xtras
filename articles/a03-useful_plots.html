<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Useful uncommon plots • xpose.xtras</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Useful uncommon plots">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xpose.xtras</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a01-the-xp_xtra-object.html">The extended xpose data object</a></li>
    <li><a class="dropdown-item" href="../articles/a02-xpose-sets.html">Using xpose sets</a></li>
    <li><a class="dropdown-item" href="../articles/a03-useful_plots.html">Useful uncommon plots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Useful uncommon plots</h1>
            
      

      <div class="d-none name"><code>a03-useful_plots.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>xpose.xtras</code> package attempts to bring old favorites
back to the <code>xpose</code> framework from its predecessor
<code>xpose4</code>, and those are named as such to allow easy access to
documentation. This vignette brings focus to the visualizations in this
package that are unlikely to be used for most projects, but are still
helpful to have when they are needed. The underlying functionality for
these plots are also useful to generalize to similar use cases that will
continue to have the benefit of being within the <code>xpose</code>
framework.</p>
</div>
<div class="section level2">
<h2 id="model-averaged-plots">Model-averaged plots<a class="anchor" aria-label="anchor" href="#model-averaged-plots"></a>
</h2>
<p>Model-averaging can be useful when two or more models can describe
different aspects of the data or the pharmacology, but for various
reasons a mixture model or other population approach would be
inadequate. It can also be helpful when multiple models have been
developed for various populations and a new population being fit does
not necessarily consist entirely of any previously fitted
population.</p>
<p>This package facilitates the generation of model-averaged
diagnostics. The approach is rudimentary and experimental, merely
creating an averaged version of an <code>xpose_data</code> object from
an <code>xpose_set</code>. As referenced in the documentation, the Model
Selection and Model Averaged Algorithms used by Uster et al. are
implemented to do this averaging (<code><a href="../reference/modavg_xpdb.html">?modavg_xpdb</a></code>). Because
both algorithms require individual objective functions, there is an
argument to automatically apply <code><a href="../reference/backfill_iofv.html">backfill_iofv()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/modavg_plots.html">ipred_vs_idv_modavg</a></span><span class="op">(</span>auto_backfill <span class="op">=</span> <span class="cn">TRUE</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="a03-useful_plots_files/figure-html/modavg-1.png" width="672inches" style="display: block; margin: auto;"></p>
<p>The default title, subtitle and caption for these experimental
figures are rough, especially for large sets. Changes for better
appearance should be expected in the future.</p>
</div>
<div class="section level2">
<h2 id="categorical-dependent-variables">Categorical dependent variables<a class="anchor" aria-label="anchor" href="#categorical-dependent-variables"></a>
</h2>
<p>Categorical DVs are frequently modeled but there are a variety of
methods used to visually diagnose these modeled endpoints, typically
model-specific. Along with adding generic support for categorical DVs,
<code>xpose.xtras</code> also adds a few plots to diagnose models
developed for them.</p>
<p>To use these diagnostics, a model for a categorical DV needs to have
the column for that DV stated (if it is “DV” that needs to be ripped
away from the <code>dv</code> variable type), and have a column
predicting the likelihood or probability of that DV having a certain
value. An example using an M3 model is below and in the
documentation.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkpd_m3</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Need to ensure var types are set</span></span>
<span>  <span class="fu"><a href="../reference/set_var_types.html">set_var_types</a></span><span class="op">(</span>catdv<span class="op">=</span><span class="va">BLQ</span>,dvprobs<span class="op">=</span><span class="va">LIKE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Set probs ("LIKE is the probability tht BLQ is 1")</span></span>
<span>  <span class="fu"><a href="../reference/set_dv_probs.html">set_dv_probs</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">~</span><span class="va">LIKE</span>, .dv_var <span class="op">=</span> <span class="va">BLQ</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Optional, but useful to set levels</span></span>
<span>  <span class="fu"><a href="../reference/set_var_levels.html">set_var_levels</a></span><span class="op">(</span><span class="fl">1</span>, BLQ <span class="op">=</span> <span class="fu"><a href="../reference/levelers.html">lvl_bin</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/catdv_vs_dvprobs.html">catdv_vs_dvprobs</a></span><span class="op">(</span>quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
<p><img src="a03-useful_plots_files/figure-html/m3-1.png" width="672inches" style="display: block; margin: auto;"></p>
<p>It is expected that there will be a somewhat sigmoidal or at least
up- and right-ward relationship between the two sets of observations in
an adequate model, but as with all diagnostics the interpretation for
this plot is subjective to an extent.</p>
<p>All plots for categorical DVs have at most two sets of data. It is
untested what would happen if all observations fell into one category,
but it is unlikely to produce a good model. This is relevant because the
<code>catdv</code> functions can still be used for models that have
multiple levels, such as the vismodegib muscle spasm model (from Lu et
al.) built into the examples. For these models, the plot is essentially
dichotomizing the probability of one observation compared to the
probability of not that observation,</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vismo_xpdb</span> <span class="op">&lt;-</span> <span class="va">vismo_pomod</span>  <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_var_types.html">set_var_types</a></span><span class="op">(</span>.problem<span class="op">=</span><span class="fl">1</span>, catdv<span class="op">=</span><span class="va">DV</span>, dvprobs<span class="op">=</span><span class="fu">matches</span><span class="op">(</span><span class="st">"^P\\d+$"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_dv_probs.html">set_dv_probs</a></span><span class="op">(</span>.problem<span class="op">=</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">~</span><span class="va">P0</span>,<span class="fl">1</span><span class="op">~</span><span class="va">P1</span>,<span class="fu">ge</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">~</span><span class="va">P23</span><span class="op">)</span></span>
<span><span class="va">vismo_xpdb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/catdv_vs_dvprobs.html">catdv_vs_dvprobs</a></span><span class="op">(</span>quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
<p><img src="a03-useful_plots_files/figure-html/vismo-1.png" width="672inches" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vismo_xpdb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/catdv_vs_dvprobs.html">catdv_vs_dvprobs</a></span><span class="op">(</span>cutpoint <span class="op">=</span> <span class="fl">2</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
<p><img src="a03-useful_plots_files/figure-html/vismo-2.png" width="672inches" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vismo_xpdb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/catdv_vs_dvprobs.html">catdv_vs_dvprobs</a></span><span class="op">(</span>cutpoint <span class="op">=</span> <span class="fl">3</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
<p><img src="a03-useful_plots_files/figure-html/vismo-3.png" width="672inches" style="display: block; margin: auto;"></p>
<p>None of the examples can be used to demonstrate this easily, but
these plots can also be model-averaged using the generic
<code><a href="../reference/modavg_plots.html">plotfun_modavg()</a></code> function.</p>
</div>
<div class="section level2">
<h2 id="waterfall-and-objective-function-trends">Waterfall and objective function trends<a class="anchor" aria-label="anchor" href="#waterfall-and-objective-function-trends"></a>
</h2>
<p>The more common needs for an <code>xpose_set</code> include
model-building tables, covariate testing and visualization. However,
there are occasions where a visual description of what can be shown in
these tables can be useful.</p>
<p>The default waterfall plot compares scales the change in parameter
values, which is intended to make relative comparisons the focus. This
is especially beneficial in comparing changes in empirical Bayes
estimates (EBEs).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/waterfalls.html">eta_waterfall</a></span><span class="op">(</span><span class="va">run3</span>,<span class="va">run6</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03-useful_plots_files/figure-html/waterfall-1.png" width="672inches" style="display: block; margin: auto;"></p>
<p>Waterfalls can also be used as an alternative to shark plots. Scaling
in that case is off by default.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pheno_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/focus_xpdb.html">focus_qapply</a></span><span class="op">(</span><span class="va">backfill_iofv</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/waterfalls.html">iofv_waterfall</a></span><span class="op">(</span><span class="va">run3</span>,<span class="va">run6</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03-useful_plots_files/figure-html/waterfall2-1.png" width="672inches" style="display: block; margin: auto;"></p>
<p>To track iOFV changes over multiple models, another plot can be
used.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/iofv_vs_mod.html">iofv_vs_mod</a></span><span class="op">(</span><span class="va">pheno_set</span>, auto_backfill <span class="op">=</span> <span class="cn">TRUE</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a03-useful_plots_files/figure-html/ofv_change-1.png" width="672inches" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Prybylski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
